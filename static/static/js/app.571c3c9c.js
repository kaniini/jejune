(function(t){function e(e){for(var o,a,r=e[0],s=e[1],u=e[2],d=0,p=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(c,a)&&c[a]&&p.push(c[a][0]),c[a]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o]);l&&l(e);while(p.length)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,r=1;r<n.length;r++){var s=n[r];0!==c[s]&&(o=!1)}o&&(i.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},c={app:0},i=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=e,r=r.slice();for(var u=0;u<r.length;u++)e(r[u]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0fd8":function(t,e,n){},4183:function(t,e,n){"use strict";n("b305")},5425:function(t,e,n){"use strict";n("0fd8")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23");function c(t,e,n,c,i,a){var r=Object(o["w"])("ComposerModal"),s=Object(o["w"])("NavBar"),u=Object(o["w"])("router-view");return Object(o["p"])(),Object(o["d"])(o["a"],null,[i.showComposerModal?(Object(o["p"])(),Object(o["d"])(r,{key:0})):Object(o["e"])("",!0),i.actor?(Object(o["p"])(),Object(o["d"])(s,{key:1})):Object(o["e"])("",!0),Object(o["g"])(u)],64)}var i={class:"nav-container"},a={class:"right-nav"},r=Object(o["g"])("i",{class:"icon-home"},null,-1),s=Object(o["g"])("i",{class:"icon-user"},null,-1),u=Object(o["g"])("ul",{class:"left-nav"},[Object(o["g"])("li",null,[Object(o["g"])("strong",null,"Jejune")])],-1);function l(t,e,n,c,l,d){var p=Object(o["w"])("router-link"),b=Object(o["w"])("UserNavAvatar");return Object(o["p"])(),Object(o["d"])("nav",null,[Object(o["g"])("div",i,[Object(o["g"])("ul",a,[Object(o["g"])("li",null,[Object(o["g"])(p,{to:"/.well-known/jejune"},{default:Object(o["C"])((function(){return[r]})),_:1})]),Object(o["g"])("li",null,[Object(o["g"])(p,{to:"/.well-known/jejune/account"},{default:Object(o["C"])((function(){return[s]})),_:1})]),Object(o["g"])("li",null,[Object(o["g"])(b,{actor:t.$root.actor},null,8,["actor"])])]),u])])}var d=Object(o["F"])("data-v-dffbc5ce");Object(o["s"])("data-v-dffbc5ce");var p={class:"user-nav-avatar"},b={class:"user-nav-petname"};Object(o["q"])();var h=d((function(t,e,n,c,i,a){return Object(o["p"])(),Object(o["d"])("div",p,[Object(o["g"])("img",{src:n.actor.iconURL()},null,8,["src"]),Object(o["g"])("span",b,Object(o["y"])(n.actor.data.petName),1)])})),f={name:"UserNavAvatar",props:["actor"]};n("d1b8");f.render=h,f.__scopeId="data-v-dffbc5ce";var j=f,O={name:"NavBar",components:{UserNavAvatar:j}};n("fd8e");O.render=l;var m=O,v={class:"composer-modal-inner"},g={class:"composer-me"},y={class:"composer-container"},w={class:"composer-form"},k=Object(o["g"])("div",{class:"composer-element"},[Object(o["g"])("strong",null,"Warning!"),Object(o["f"])(" Addressing for posts is not yet implemented! All posts are addressed to "),Object(o["g"])("code",null,"as:Public"),Object(o["f"])("! ")],-1),A={key:0,class:"composer-attachments"},C={class:"composer-element"};function T(t,e,n,c,i,a){var r=Object(o["w"])("Attachment"),s=Object(o["w"])("MediaUploader");return Object(o["p"])(),Object(o["d"])("div",{class:"composer-modal-outer",onClick:e[5]||(e[5]=Object(o["E"])((function(t){return a.hide()}),["self"]))},[Object(o["g"])("div",v,[Object(o["g"])("div",g,[Object(o["g"])("img",{src:t.$root.actor.iconURL(),alt:"$root.actor.data.name"},null,8,["src"])]),Object(o["g"])("div",y,[Object(o["g"])("div",w,[Object(o["D"])(Object(o["g"])("input",{type:"text",id:"composer-title",placeholder:"Title","onUpdate:modelValue":e[1]||(e[1]=function(t){return i.title=t})},null,512),[[o["A"],i.title]]),Object(o["D"])(Object(o["g"])("input",{type:"text",id:"composer-summary",placeholder:"Summary","onUpdate:modelValue":e[2]||(e[2]=function(t){return i.summary=t})},null,512),[[o["A"],i.summary]]),Object(o["D"])(Object(o["g"])("textarea",{rows:"10",id:"composer-content",placeholder:"Content (use Markdown)","onUpdate:modelValue":e[3]||(e[3]=function(t){return i.source=t})},null,512),[[o["A"],i.source]]),k,i.attachment?(Object(o["p"])(),Object(o["d"])("div",A,[(Object(o["p"])(!0),Object(o["d"])(o["a"],null,Object(o["v"])(i.attachment,(function(t){return Object(o["p"])(),Object(o["d"])("div",{key:t.url,class:"attachment"},[Object(o["g"])(r,{attachment:t},null,8,["attachment"])])})),128))])):Object(o["e"])("",!0),Object(o["g"])(s),Object(o["g"])("div",C,[Object(o["g"])("button",{type:"submit",onClick:e[4]||(e[4]=Object(o["E"])((function(t){return a.submit()}),["prevent"]))},"Post")])])])])])}n("99af");var M=Object(o["g"])("label",{for:"fileUpload"},[Object(o["g"])("i",{class:"icon-upload"})],-1);function _(t,e,n,c,i,a){return Object(o["p"])(),Object(o["d"])("div",null,[M,Object(o["g"])("input",{id:"fileUpload",type:"file",style:{display:"none"},multiple:"true",onChange:e[1]||(e[1]=function(t){return a.change(t)})},null,32)])}n("4160"),n("159b");var x={name:"MediaUploader",data:function(){return{uploading:!1,uploadCounter:0}},methods:{change:function(t){var e=this,n=t.target,o=n.files;n.files=null,o.forEach((function(t){console.log("upload",t);var n=e.$root.actor;n.uploadMedia(t).then((function(t){e.$root.showComposerModalAttachment.push(t),e.uploading=!1})).catch((function(t){console.log("Upload error:",t)}))})),this.uploading=!0}}};x.render=_;var E=x;n("b0c0"),n("2ca0");function P(t,e,n,c,i,a){return Object(o["p"])(),Object(o["d"])("div",null,[n.attachment.mediaType.startsWith("image")?(Object(o["p"])(),Object(o["d"])("img",{key:0,src:n.attachment.url,alt:n.attachment.name},null,8,["src","alt"])):Object(o["e"])("",!0),n.attachment.mediaType.startsWith("video")?(Object(o["p"])(),Object(o["d"])("video",{key:1,src:n.attachment.url,controls:""},null,8,["src"])):Object(o["e"])("",!0),n.attachment.mediaType.startsWith("audio")?(Object(o["p"])(),Object(o["d"])("audio",{key:2,src:n.attachment.url,controls:""},null,8,["src"])):Object(o["e"])("",!0)])}var U={name:"Attachment",props:["attachment"]};U.render=P;var $=U,L={name:"ComposerModal",components:{Attachment:$,MediaUploader:E},data:function(){return{error:null,source:null,summary:null,title:null,inReplyTo:this.$root.showComposerModalInReplyTo,attachment:this.$root.showComposerModalAttachment}},methods:{submit:function(){var t=this,e=this.$root.actor,n=[e.data.id,"https://www.w3.org/ns/activitystreams#Public"],o=[e.data.followers],c={audience:n.concat(o),name:this.title,summary:this.summary,source:{content:this.source,mediaType:"text/markdown"},attributedTo:e.data.id,type:"Note"};this.inReplyTo&&(c.inReplyTo=this.inReplyTo.id),this.attachment&&(c.attachment=this.attachment);var i={"@context":"https://www.w3.org/ns/activitystreams",to:n,cc:o,audience:n.concat(o),type:"Create",actor:e.data.id,object:c};e.pushMessageToOutbox(i).then((function(e){"accepted"==e.status&&t.hide()})).catch((function(e){t.error=e}))},hide:function(){this.$root.showComposerModal=null,this.$root.showComposerModalInReplyTo=null,this.$root.showComposerModalAttachment=[]}}};n("9843");L.render=T;var R=L,I={name:"App",components:{NavBar:m,ComposerModal:R},data:function(){return{actor:null,showComposerModal:null,showComposerModalInReplyTo:null,showComposerModalAttachment:[]}}};n("d967");I.render=c;var S=I,N=n("6c02"),D={class:"dashboard"};function H(t,e,n,c,i,a){var r=Object(o["w"])("Composer"),s=Object(o["w"])("InboxCollection");return Object(o["p"])(),Object(o["d"])("div",D,[Object(o["g"])(r),Object(o["g"])(s,{actor:t.$root.actor},null,8,["actor"])])}function B(t,e,n,c,i,a){var r=Object(o["w"])("ActivityCollection");return Object(o["p"])(),Object(o["d"])(r,{activities:i.activities},null,8,["activities"])}n("4de4"),n("c975");function F(t,e,n,c,i,a){var r=Object(o["w"])("Activity");return Object(o["p"])(!0),Object(o["d"])(o["a"],null,Object(o["v"])(n.activities,(function(t){return Object(o["p"])(),Object(o["d"])(r,{key:t.id,activity:t},null,8,["activity"])})),128)}var W={class:"activity-container"},V={class:"activity-author"},z={class:"activity-content"},J={key:0,class:"activity-header"},q={class:"activity-author"},G={key:0,class:"activity-attribution"},K={class:"activity-descriptor"},Q={key:0,class:"icon-retweet"},X={key:1,class:"icon-mail-alt"},Y={key:2,class:"icon-star"},Z={class:"activity-author"},tt={class:"activity-payload"},et={key:0,class:"activity-attachments"},nt={class:"activity-footer"},ot={class:"activity-reactions"},ct=Object(o["g"])("i",{class:"icon-reply"},null,-1),it=Object(o["g"])("i",{class:"icon-star-empty"},null,-1),at=Object(o["g"])("i",{class:"icon-retweet"},null,-1),rt={class:"activity-interactions"};function st(t,e,n,c,i,a){var r=Object(o["w"])("_self"),s=Object(o["w"])("Attachment");return Object(o["p"])(),Object(o["d"])("div",W,[Object(o["g"])("div",V,[i.actor?(Object(o["p"])(),Object(o["d"])("a",{key:0,href:i.actor.data.url,target:"_blank",alt:i.actor.data.name},[Object(o["g"])("img",{src:i.actor.iconURL(),class:"activity-icon"},null,8,["src"])],8,["href","alt"])):Object(o["e"])("",!0)]),Object(o["g"])("div",z,[i.actor?(Object(o["p"])(),Object(o["d"])("div",J,[Object(o["g"])("span",q,[Object(o["g"])("a",{href:i.actor.data.url,target:"_blank"},Object(o["y"])(i.actor.data.name),9,["href"])]),i.child_actor&&i.child_actor.data.id!=i.actor.data.id?(Object(o["p"])(),Object(o["d"])("span",G,[Object(o["g"])("span",K,["Announce"==i.type?(Object(o["p"])(),Object(o["d"])("i",Q)):Object(o["e"])("",!0),"Create"==i.type?(Object(o["p"])(),Object(o["d"])("i",X)):Object(o["e"])("",!0),"Like"==i.type?(Object(o["p"])(),Object(o["d"])("i",Y)):Object(o["e"])("",!0)]),Object(o["g"])("span",Z,[Object(o["g"])("a",{href:i.child_actor.data.url,target:"_blank"},Object(o["y"])(i.child_actor.data.name),9,["href"])])])):Object(o["e"])("",!0)])):Object(o["e"])("",!0),i.in_reply_to?(Object(o["p"])(),Object(o["d"])(r,{key:1,activity:i.in_reply_to},null,8,["activity"])):Object(o["e"])("",!0),Object(o["g"])("div",tt,[i.child.attachment?(Object(o["p"])(),Object(o["d"])("div",et,[(Object(o["p"])(!0),Object(o["d"])(o["a"],null,Object(o["v"])(i.child.attachment,(function(t){return Object(o["p"])(),Object(o["d"])("div",{key:t.url,class:"attachment"},[Object(o["g"])(s,{attachment:t},null,8,["attachment"])])})),128))])):Object(o["e"])("",!0),i.child.name?(Object(o["p"])(),Object(o["d"])("h2",{key:1,innerHTML:i.child.name},null,8,["innerHTML"])):Object(o["e"])("",!0),i.child.summary?(Object(o["p"])(),Object(o["d"])("h3",{key:2,innerHTML:i.child.summary},null,8,["innerHTML"])):Object(o["e"])("",!0),i.child.content?(Object(o["p"])(),Object(o["d"])("div",{key:3,class:"activity-payload-content",innerHTML:i.child.content},null,8,["innerHTML"])):Object(o["e"])("",!0)]),Object(o["g"])("div",nt,[Object(o["g"])("div",ot,[Object(o["g"])("ul",null,[Object(o["g"])("li",null,[Object(o["g"])("a",{onClick:e[1]||(e[1]=Object(o["E"])((function(t){return a.reply()}),["prevent"]))},[ct])]),Object(o["g"])("li",null,[Object(o["g"])("a",{onClick:e[2]||(e[2]=Object(o["E"])((function(t){return a.like()}),["prevent"]))},[it])]),Object(o["g"])("li",null,[Object(o["g"])("a",{onClick:e[3]||(e[3]=Object(o["E"])((function(t){return a.announce()}),["prevent"]))},[at])])])]),Object(o["g"])("div",rt,Object(o["y"])(i.interactions)+" interactions ",1)])])])}n("d3b7");function ut(t){this.data=t}ut.prototype.inboxURL=function(){return this.data.inbox?this.data.inbox:null},ut.prototype.iconURL=function(){return this.data.icon&&this.data.icon.url?this.data.icon.url:null},ut.prototype.like=function(t){var e=["https://www.w3.org/ns/activitystreams#Public",t.attributedTo],n=[this.data.followers],o=e.concat(n),c={"@context":"https://www.w3.org/ns/activitystreams",to:e,cc:n,actor:this.data.id,audience:o,type:"Like",object:t.id};return this.pushMessageToOutbox(c)},ut.prototype.announce=function(t){var e=["https://www.w3.org/ns/activitystreams#Public",t.attributedTo],n=[this.data.followers],o=e.concat(n),c={"@context":"https://www.w3.org/ns/activitystreams",to:e,cc:n,actor:this.data.id,audience:o,type:"Announce",object:t.id};return this.pushMessageToOutbox(c)},ut.prototype.pushMessageToOutbox=function(t){var e=this;return new Promise((function(n,o){var c=e.data.outbox;fetch(c,{method:"POST",headers:{Accept:"application/activity+json",Authorization:"Bearer ".concat(e.token.access_token),"Content-Type":"application/activity+json"},body:JSON.stringify(t)}).then((function(t){return t.json()})).then((function(t){n(t)})).catch((function(t){o(t)}))}))},ut.prototype.fetchMailboxWithToken=function(t){var e=this;return new Promise((function(n,o){fetch(t,{headers:{Accept:"application/activity+json",Authorization:"Bearer ".concat(e.token.access_token)}}).then((function(t){return t.json()})).then((function(t){n(t)})).catch((function(t){o(t)}))}))},ut.prototype.fetchInbox=function(){var t=this;return new Promise((function(e,n){t.token||n("no token for fetching inbox");var o=t.inboxURL()+"?page=0";t.fetchMailboxWithToken(o).then((function(t){e(t)})).catch((function(t){n(t)}))}))},ut.prototype.uploadMediaEndpoint=function(){return this.data.endpoints.uploadMedia},ut.prototype.uploadMedia=function(t){var e=this;return new Promise((function(n,o){var c=e.uploadMediaEndpoint();c||o("Media upload endpoint is not available.");var i=new FormData;i.append("file",t),fetch(c,{method:"POST",headers:{Accept:"application/activity+json",Authorization:"Bearer ".concat(e.token.access_token)},body:i}).then((function(t){return t.json()})).then((function(t){n(t)})).catch((function(t){o(t)}))}))},ut.prototype.setToken=function(t){this.token=t},ut.prototype.oAuthEndpoints=function(){var t={};return this.data.endpoints.oauthRegistrationEndpoint&&(t.registration=this.data.endpoints.oauthRegistrationEndpoint),this.data.endpoints.oauthAuthorizationEndpoint&&(t.authorization=this.data.endpoints.oauthAuthorizationEndpoint),this.data.endpoints.oauthTokenEndpoint&&(t.token=this.data.endpoints.oauthTokenEndpoint),t};var lt={},dt=function(t){return new Promise((function(e,n){fetch(t,{headers:{Accept:"application/activity+json"}}).then((function(t){return t.json()})).then((function(n){lt[t]=new ut(n),e(lt[t])})).catch((function(t){n(t)}))}))},pt=function(t){return new Promise((function(e,n){fetch(t,{headers:{Accept:"application/activity+json"}}).then((function(t){return t.json()})).then((function(t){e(t)})).catch((function(t){n(t)}))}))},bt={fetchActor:dt,fetchObject:pt},ht={name:"Activity",props:["activity"],components:{Attachment:$},data:function(){return{type:this.activity.type,child:this.activity.object,actor:null,child_actor:null,in_reply_to:null,interactions:0}},mounted:function(){var t=this;bt.fetchActor(this.activity.actor).then((function(e){t.actor=e})),this.child&&this.child.attributedTo&&bt.fetchActor(this.child.attributedTo).then((function(e){t.child_actor=e}));var e=!1;e&&this.child&&this.child.inReplyTo&&bt.fetchObject(this.child.inReplyTo).then((function(e){t.in_reply_to={type:"Create",object:e,actor:e.attributedTo}}))},methods:{reply:function(){this.$root.showComposerModal="text",this.$root.showComposerModalInReplyTo=this.child},like:function(){var t=this.$root.actor;t.like(this.child)},announce:function(){var t=this.$root.actor;t.announce(this.child)}}};n("5425");ht.render=st;var ft=ht,jt={name:"ActivityCollection",props:["activities"],components:{Activity:ft}};jt.render=F;var Ot=jt,mt={name:"InboxCollection",props:["actor"],components:{ActivityCollection:Ot},data:function(){return{activities:[]}},mounted:function(){var t=this;this.actor&&this.actor.fetchInbox().then((function(e){t.activities=e.orderedItems.filter((function(t){if(-1!=["Create","Announce"].indexOf(t.type))return!0}))})).catch((function(t){console.log("error:",t)}))}};mt.render=B;var vt=mt,gt={key:0,class:"composer"},yt={class:"composer-me"},wt={class:"composer-container"},kt={class:"composer-post-types"},At=Object(o["g"])("i",{class:"composer-icon icon-font"},null,-1),Ct=Object(o["g"])("br",null,null,-1),Tt=Object(o["f"])(" Text "),Mt=Object(o["g"])("i",{class:"composer-icon icon-camera"},null,-1),_t=Object(o["g"])("br",null,null,-1),xt=Object(o["f"])(" Image "),Et=Object(o["g"])("i",{class:"composer-icon icon-videocam"},null,-1),Pt=Object(o["g"])("br",null,null,-1),Ut=Object(o["f"])(" Video "),$t=Object(o["g"])("i",{class:"composer-icon icon-volume-up"},null,-1),Lt=Object(o["g"])("br",null,null,-1),Rt=Object(o["f"])(" Audio ");function It(t,e,n,c,i,a){return t.$root.actor?(Object(o["p"])(),Object(o["d"])("div",gt,[Object(o["g"])("div",yt,[Object(o["g"])("img",{src:t.$root.actor.iconURL(),alt:"$root.actor.data.name"},null,8,["src"])]),Object(o["g"])("div",wt,[Object(o["g"])("div",kt,[Object(o["g"])("div",{class:"composer-post-type",onClick:e[1]||(e[1]=function(t){return a.openComposerModal("text")})},[At,Ct,Tt]),Object(o["g"])("div",{class:"composer-post-type",onClick:e[2]||(e[2]=function(t){return a.openComposerModal("image")})},[Mt,_t,xt]),Object(o["g"])("div",{class:"composer-post-type",onClick:e[3]||(e[3]=function(t){return a.openComposerModal("video")})},[Et,Pt,Ut]),Object(o["g"])("div",{class:"composer-post-type",onClick:e[4]||(e[4]=function(t){return a.openComposerModal("audio")})},[$t,Lt,Rt])])])])):Object(o["e"])("",!0)}var St={name:"Composer",methods:{openComposerModal:function(t){this.$root.showComposerModal=t}}};n("4183");St.render=It;var Nt=St,Dt={name:"Home",components:{InboxCollection:vt,Composer:Nt},mounted:function(){this.$root.actor||this.$router.push("/.well-known/jejune/login")}};n("8b6a");Dt.render=H;var Ht=Dt;function Bt(t,e,n,c,i,a){var r=Object(o["w"])("login-form");return Object(o["p"])(),Object(o["d"])(r)}var Ft={class:"login-form-container"},Wt=Object(o["g"])("h2",null,"Jejune",-1),Vt={key:0,class:"login-error"},zt={class:"form-input"},Jt=Object(o["g"])("label",{for:"username"},"Username",-1),qt={class:"form-input"},Gt=Object(o["g"])("label",{for:"password"},"Password",-1),Kt=Object(o["g"])("button",{type:"submit",id:"login"},"Log In",-1);function Qt(t,e,n,c,i,a){return Object(o["p"])(),Object(o["d"])("div",Ft,[Object(o["g"])("form",{onSubmit:e[3]||(e[3]=Object(o["E"])((function(e){return a.submit(t.user)}),["prevent"])),class:"login-form"},[Wt,t.authError?(Object(o["p"])(),Object(o["d"])("div",Vt,Object(o["y"])(t.authError),1)):Object(o["e"])("",!0),Object(o["g"])("div",zt,[Jt,Object(o["D"])(Object(o["g"])("input",{id:"username","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.username=e}),type:"text"},null,512),[[o["A"],t.username]])]),Object(o["g"])("div",qt,[Gt,Object(o["D"])(Object(o["g"])("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=function(e){return t.password=e}),type:"password"},null,512),[[o["A"],t.password]])]),Kt],32)])}n("ac1f"),n("1276");var Xt=function(t){return new Promise((function(e,n){t||n(new Error("invalid account"));var o=t.split("@",2);2!=o.length&&n(new Error("must use username@domain format")),console.log("[WEBFINGER] Discovering",o),fetch("https://".concat(o[1],"/.well-known/webfinger?resource=acct:").concat(t)).then((function(t){return t.json()})).then((function(t){console.log("[WEBFINGER] Response:",t),e(t)})).catch((function(t){n(t)}))}))},Yt=function(t){return new Promise((function(e,n){Xt(t).then((function(t){var o=t.links||[];o.forEach((function(t){"application/activity+json"===t.type&&e(t.href)})),n("no ActivityPub actor found!")})).catch((function(t){n(t)}))}))},Zt={finger:Xt,discoverActor:Yt},te=function(t){return new Promise((function(e,n){var o=new FormData;o.append("client_name","Jejune Client"),o.append("redirect_uris","urn:ietf:wg:oauth:2.0:oob"),o.append("scopes","read write follow push");var c=t.oAuthEndpoints();fetch(c.registration,{method:"POST",body:o}).then((function(t){return t.json()})).then((function(t){e(t)})).catch((function(t){n(t)}))}))},ee=function(t,e,n,o){return new Promise((function(c,i){var a=t.oAuthEndpoints(),r=n.split("@",2)[0],s=new FormData;s.append("username",r),s.append("password",o),s.append("grant_type","password"),s.append("client_id",e.client_id),s.append("client_secret",e.client_secret),fetch(a.token,{method:"POST",body:s}).then((function(t){return t.ok||i("Unable to acquire an OAuth session token with the supplied credentials."),t.json()})).then((function(t){c(t)})).catch((function(t){i(t)}))}))},ne=function(t,e,n){return new Promise((function(o,c){te(t).then((function(i){console.log("[OAUTH] App token:",i),ee(t,i,e,n).then((function(t){o(t)})).catch((function(t){c(t)}))})).catch((function(t){c(t)}))}))},oe={getToken:ne},ce=function(t,e){return console.log("[TOPLEVEL] Attempting login for ".concat(t)),new Promise((function(n,o){Zt.discoverActor(t).then((function(c){bt.fetchActor(c).then((function(c){oe.getToken(c,t,e).then((function(t){c.setToken(t),n(c)})).catch((function(t){o(t)}))})).catch((function(t){o(t)}))})).catch((function(t){o(t)}))}))},ie={login:ce},ae={name:"LoginForm",data:function(){return{username:null,password:null,authError:null}},methods:{submit:function(){var t=this;ie.login(this.username,this.password).then((function(e){t.$root.actor=e,t.$router.push("/.well-known/jejune")})).catch((function(e){console.log("Login error:",e),t.authError=e}))}}};n("d2ee");ae.render=Qt;var re=ae,se={name:"Login",components:{LoginForm:re}};se.render=Bt;var ue=se,le=[{path:"/.well-known/jejune",name:"Home",component:Ht},{path:"/.well-known/jejune/login",name:"Login",component:ue}],de=Object(N["a"])({history:Object(N["b"])("/"),routes:le}),pe=de;Object(o["c"])(S).use(pe).mount("#app")},"7bf1":function(t,e,n){},"8b6a":function(t,e,n){"use strict";n("f818")},9095:function(t,e,n){},9647:function(t,e,n){},9843:function(t,e,n){"use strict";n("b5e4")},b305:function(t,e,n){},b5e4:function(t,e,n){},d1b8:function(t,e,n){"use strict";n("9647")},d2ee:function(t,e,n){"use strict";n("9095")},d967:function(t,e,n){"use strict";n("7bf1")},f7be:function(t,e,n){},f818:function(t,e,n){},fd8e:function(t,e,n){"use strict";n("f7be")}});
//# sourceMappingURL=app.571c3c9c.js.map