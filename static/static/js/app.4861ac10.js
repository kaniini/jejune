(function(t){function e(e){for(var c,a,r=e[0],s=e[1],l=e[2],d=0,p=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(c in s)Object.prototype.hasOwnProperty.call(s,c)&&(t[c]=s[c]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],c=!0,r=1;r<n.length;r++){var s=n[r];0!==o[s]&&(c=!1)}c&&(i.splice(e--,1),t=a(a.s=n[0]))}return t}var c={},o={app:0},i=[];function a(e){if(c[e])return c[e].exports;var n=c[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=c,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var c in t)a.d(n,c,function(e){return t[e]}.bind(null,c));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=s;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"163f":function(t,e,n){},"18f1":function(t,e,n){"use strict";n("81aa")},"1f56":function(t,e,n){},"23ac":function(t,e,n){"use strict";n("4b50")},3500:function(t,e,n){"use strict";n("1f56")},3800:function(t,e,n){"use strict";n("163f")},4183:function(t,e,n){"use strict";n("b305")},"4b50":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var c=n("7a23");function o(t,e,n,o,i,a){var r=Object(c["w"])("LightBox"),s=Object(c["w"])("ComposerModal"),l=Object(c["w"])("NavBar"),u=Object(c["w"])("router-view");return Object(c["p"])(),Object(c["d"])(c["a"],null,[i.showLightBox?(Object(c["p"])(),Object(c["d"])(r,{key:0,attachment:i.showLightBox},null,8,["attachment"])):Object(c["e"])("",!0),i.showComposerModal?(Object(c["p"])(),Object(c["d"])(s,{key:1})):Object(c["e"])("",!0),i.actor?(Object(c["p"])(),Object(c["d"])(l,{key:2})):Object(c["e"])("",!0),Object(c["g"])(u)],64)}var i={class:"nav-container"},a={class:"right-nav"},r=Object(c["g"])("i",{class:"icon-home"},null,-1),s=Object(c["g"])("i",{class:"icon-user"},null,-1),l={class:"left-nav"},u=Object(c["g"])("li",null,[Object(c["g"])("strong",null,"Jejune")],-1);function d(t,e,n,o,d,p){var h=Object(c["w"])("router-link"),b=Object(c["w"])("UserNavAvatar"),j=Object(c["w"])("SearchBox");return Object(c["p"])(),Object(c["d"])("nav",null,[Object(c["g"])("div",i,[Object(c["g"])("ul",a,[Object(c["g"])("li",null,[Object(c["g"])(h,{to:"/.well-known/jejune"},{default:Object(c["C"])((function(){return[r]})),_:1})]),Object(c["g"])("li",null,[Object(c["g"])(h,{to:"/.well-known/jejune/account"},{default:Object(c["C"])((function(){return[s]})),_:1})]),Object(c["g"])("li",null,[Object(c["g"])(b,{actor:t.$root.actor},null,8,["actor"])])]),Object(c["g"])("ul",l,[u,Object(c["g"])("li",null,[Object(c["g"])(j)])])])])}var p=Object(c["G"])("data-v-dffbc5ce");Object(c["s"])("data-v-dffbc5ce");var h={class:"user-nav-avatar"},b={class:"user-nav-petname"};Object(c["q"])();var j=p((function(t,e,n,o,i,a){return Object(c["p"])(),Object(c["d"])("div",h,[Object(c["g"])("img",{src:n.actor.iconURL()},null,8,["src"]),Object(c["g"])("span",b,Object(c["y"])(n.actor.data.petName),1)])})),f={name:"UserNavAvatar",props:["actor"]};n("d1b8");f.render=j,f.__scopeId="data-v-dffbc5ce";var O=f,m={class:"search-box"},v=Object(c["g"])("div",{class:"search-icon"},[Object(c["g"])("i",{class:"icon-search"})],-1);function y(t,e,n,o,i,a){return Object(c["p"])(),Object(c["d"])("div",m,[v,Object(c["D"])(Object(c["g"])("input",{class:"search-container",type:"text",id:"search","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.$root.search_term=e}),placeholder:"Search",onKeyup:e[2]||(e[2]=Object(c["E"])((function(){return a.doSearch&&a.doSearch.apply(a,arguments)}),["enter"]))},null,544),[[c["A"],t.$root.search_term]])])}var g={name:"SearchBox",methods:{doSearch:function(){this.$router.push("/.well-known/jejune/search")}}};n("3500");g.render=y;var w=g,k={name:"NavBar",components:{UserNavAvatar:O,SearchBox:w}};n("65ea");k.render=d;var A=k,C={class:"composer-modal-inner"},x={class:"composer-me"},_={class:"composer-container"},T={class:"composer-form"},M=Object(c["g"])("div",{class:"composer-element"},[Object(c["g"])("strong",null,"Warning!"),Object(c["f"])(" Addressing for posts is not yet implemented! All posts are addressed to "),Object(c["g"])("code",null,"as:Public"),Object(c["f"])("! ")],-1),L={key:0,class:"composer-attachments"},P={class:"composer-element"};function $(t,e,n,o,i,a){var r=Object(c["w"])("Attachment"),s=Object(c["w"])("MediaUploader");return Object(c["p"])(),Object(c["d"])("div",{class:"composer-modal-outer",onClick:e[5]||(e[5]=Object(c["F"])((function(t){return a.hide()}),["self"]))},[Object(c["g"])("div",C,[Object(c["g"])("div",x,[Object(c["g"])("img",{src:t.$root.actor.iconURL(),alt:"$root.actor.data.name"},null,8,["src"])]),Object(c["g"])("div",_,[Object(c["g"])("div",T,[Object(c["D"])(Object(c["g"])("input",{type:"text",id:"composer-title",placeholder:"Title","onUpdate:modelValue":e[1]||(e[1]=function(t){return i.title=t})},null,512),[[c["A"],i.title]]),Object(c["D"])(Object(c["g"])("input",{type:"text",id:"composer-summary",placeholder:"Summary","onUpdate:modelValue":e[2]||(e[2]=function(t){return i.summary=t})},null,512),[[c["A"],i.summary]]),Object(c["D"])(Object(c["g"])("textarea",{rows:"10",id:"composer-content",placeholder:"Content (use Markdown)","onUpdate:modelValue":e[3]||(e[3]=function(t){return i.source=t})},null,512),[[c["A"],i.source]]),M,i.attachment?(Object(c["p"])(),Object(c["d"])("div",L,[(Object(c["p"])(!0),Object(c["d"])(c["a"],null,Object(c["v"])(i.attachment,(function(t){return Object(c["p"])(),Object(c["d"])("div",{key:t.url,class:"attachment"},[Object(c["g"])(r,{attachment:t},null,8,["attachment"])])})),128))])):Object(c["e"])("",!0),Object(c["g"])(s),Object(c["g"])("div",P,[Object(c["g"])("button",{type:"submit",onClick:e[4]||(e[4]=Object(c["F"])((function(t){return a.submit()}),["prevent"]))},"Post")])])])])])}n("99af");var E=Object(c["g"])("label",{for:"fileUpload"},[Object(c["g"])("i",{class:"icon-upload"})],-1);function S(t,e,n,o,i,a){return Object(c["p"])(),Object(c["d"])("div",null,[E,Object(c["g"])("input",{id:"fileUpload",type:"file",style:{display:"none"},multiple:"true",onChange:e[1]||(e[1]=function(t){return a.change(t)})},null,32)])}n("4160"),n("159b");var U={name:"MediaUploader",data:function(){return{uploading:!1,uploadCounter:0}},methods:{change:function(t){var e=this,n=t.target,c=n.files;n.files=null,c.forEach((function(t){console.log("upload",t);var n=e.$root.actor;n.uploadMedia(t).then((function(t){e.$root.showComposerModalAttachment.push(t),e.uploading=!1})).catch((function(t){console.log("Upload error:",t)}))})),this.uploading=!0}}};U.render=S;var B=U;n("b0c0"),n("2ca0");function R(t,e,n,o,i,a){return Object(c["p"])(),Object(c["d"])("div",null,[n.attachment.mediaType.startsWith("image")?(Object(c["p"])(),Object(c["d"])("img",{key:0,src:n.attachment.url,alt:n.attachment.name,onClick:e[1]||(e[1]=Object(c["F"])((function(t){return a.openLightBox()}),["prevent"]))},null,8,["src","alt"])):Object(c["e"])("",!0),n.attachment.mediaType.startsWith("video")?(Object(c["p"])(),Object(c["d"])("video",{key:1,src:n.attachment.url,controls:""},null,8,["src"])):Object(c["e"])("",!0),n.attachment.mediaType.startsWith("audio")?(Object(c["p"])(),Object(c["d"])("audio",{key:2,src:n.attachment.url,controls:""},null,8,["src"])):Object(c["e"])("",!0)])}var F={name:"Attachment",props:["attachment"],methods:{openLightBox:function(){this.$root.showLightBox||(this.$root.showLightBox=this.attachment)}}};F.render=R;var I=F,N={name:"ComposerModal",components:{Attachment:I,MediaUploader:B},data:function(){return{error:null,source:null,summary:null,title:null,inReplyTo:this.$root.showComposerModalInReplyTo,attachment:this.$root.showComposerModalAttachment}},methods:{submit:function(){var t=this,e=this.$root.actor,n=[e.data.id,"https://www.w3.org/ns/activitystreams#Public"],c=[e.data.followers],o={audience:n.concat(c),name:this.title,summary:this.summary,source:{content:this.source,mediaType:"text/markdown"},attributedTo:e.data.id,type:"Note"};this.inReplyTo&&(o.inReplyTo=this.inReplyTo.id),this.attachment&&(o.attachment=this.attachment);var i={"@context":"https://www.w3.org/ns/activitystreams",to:n,cc:c,audience:n.concat(c),type:"Create",actor:e.data.id,object:o};e.pushMessageToOutbox(i).then((function(e){"accepted"==e.status&&t.hide()})).catch((function(e){t.error=e}))},hide:function(){this.$root.showComposerModal=null,this.$root.showComposerModalInReplyTo=null,this.$root.showComposerModalAttachment=[]}}};n("9843");N.render=$;var H=N,D={class:"light-box-inner"};function z(t,e,n,o,i,a){var r=Object(c["w"])("Attachment");return Object(c["p"])(),Object(c["d"])("div",{class:"light-box",onClick:e[1]||(e[1]=function(t){return a.dismiss()})},[Object(c["g"])("div",D,[Object(c["g"])(r,{attachment:n.attachment},null,8,["attachment"]),Object(c["g"])("div",{class:"light-box-description",textContent:Object(c["y"])(n.attachment.name)},null,8,["textContent"])])])}var V={name:"LightBox",components:{Attachment:I},props:["attachment"],methods:{dismiss:function(){this.$root.showLightBox=null}}};n("23ac");V.render=z;var W=V,J={name:"App",components:{NavBar:A,ComposerModal:H,LightBox:W},data:function(){return{actor:null,showComposerModal:null,showComposerModalInReplyTo:null,showComposerModalAttachment:[],search_term:null,showLightBox:null}}};n("3800");J.render=o;var q=J,G=n("6c02"),K={class:"dashboard-parent"},Q={class:"dashboard"},X={class:"dashboard-stream"},Y=Object(c["g"])("div",{class:"dashboard-sidebar"},[Object(c["g"])("div",{class:"dashboard-widget"},[Object(c["g"])("h4",null,"Notifications"),Object(c["g"])("p",null,"Not actually implemented yet!")])],-1);function Z(t,e,n,o,i,a){var r=Object(c["w"])("Composer"),s=Object(c["w"])("InboxCollection");return Object(c["p"])(),Object(c["d"])("div",K,[Object(c["g"])("div",Q,[Object(c["g"])("div",X,[Object(c["g"])(r),Object(c["g"])(s,{actor:t.$root.actor},null,8,["actor"])]),Y])])}function tt(t,e,n,o,i,a){var r=Object(c["w"])("ActivityCollection");return Object(c["p"])(),Object(c["d"])("div",null,[Object(c["g"])(r,{activities:i.activities},null,8,["activities"])])}n("4de4"),n("c975");function et(t,e,n,o,i,a){var r=Object(c["w"])("Activity");return Object(c["p"])(!0),Object(c["d"])(c["a"],null,Object(c["v"])(n.activities,(function(t){return Object(c["p"])(),Object(c["d"])(r,{key:t.id,activity:t,is_reply:!1},null,8,["activity"])})),128)}var nt={class:"activity-container"},ct={key:0,class:"activity-author"},ot={class:"activity-content"},it={key:0,class:"activity-header"},at={class:"activity-author-name"},rt={key:1,class:"activity-attribution"},st={class:"activity-descriptor"},lt={key:0,class:"icon-retweet"},ut={key:1,class:"icon-mail-alt"},dt={key:2,class:"icon-star"},pt={class:"activity-author-name"},ht={key:3,class:"activity-payload"},bt={key:0,class:"activity-attachments"},jt={key:4,class:"activity-footer"},ft={class:"activity-reactions"},Ot=Object(c["g"])("i",{class:"icon-reply"},null,-1),mt=Object(c["g"])("i",{class:"icon-star-empty"},null,-1),vt=Object(c["g"])("i",{class:"icon-retweet"},null,-1),yt={class:"activity-interactions"};function gt(t,e,n,o,i,a){var r=Object(c["w"])("_self"),s=Object(c["w"])("Attachment");return Object(c["p"])(),Object(c["d"])("div",nt,[n.is_reply?Object(c["e"])("",!0):(Object(c["p"])(),Object(c["d"])("div",ct,[i.actor?(Object(c["p"])(),Object(c["d"])("a",{key:0,href:i.actor.url,target:"_blank",title:i.actor.name},[Object(c["g"])("img",{src:i.actor.icon.url,class:"activity-icon"},null,8,["src"])],8,["href","title"])):Object(c["e"])("",!0)])),Object(c["g"])("div",ot,[i.actor?(Object(c["p"])(),Object(c["d"])("div",it,[n.is_reply?(Object(c["p"])(),Object(c["d"])("img",{key:0,src:i.actor.icon.url,class:"activity-icon"},null,8,["src"])):Object(c["e"])("",!0),Object(c["g"])("div",at,[Object(c["g"])("a",{href:i.actor.url,target:"_blank"},Object(c["y"])(i.actor.name),9,["href"])]),i.child_actor&&i.child_actor.id!=i.actor.id?(Object(c["p"])(),Object(c["d"])("div",rt,[Object(c["g"])("span",st,["Announce"==i.type?(Object(c["p"])(),Object(c["d"])("i",lt)):Object(c["e"])("",!0),"Create"==i.type?(Object(c["p"])(),Object(c["d"])("i",ut)):Object(c["e"])("",!0),"Like"==i.type?(Object(c["p"])(),Object(c["d"])("i",dt)):Object(c["e"])("",!0)]),Object(c["g"])("span",pt,[Object(c["g"])("a",{href:i.child_actor.url,target:"_blank"},Object(c["y"])(i.child_actor.name),9,["href"])])])):Object(c["e"])("",!0)])):Object(c["e"])("",!0),i.in_reply_to&&!n.is_reply?(Object(c["p"])(),Object(c["d"])(r,{key:1,class:"nested-activity",activity:i.in_reply_to,is_reply:!0},null,8,["activity"])):Object(c["e"])("",!0),i.announcement&&!n.is_reply?(Object(c["p"])(),Object(c["d"])(r,{key:2,class:"nested-activity announcement",activity:i.announcement,is_reply:!0},null,8,["activity"])):Object(c["e"])("",!0),i.announcement?Object(c["e"])("",!0):(Object(c["p"])(),Object(c["d"])("div",ht,[i.child.attachment?(Object(c["p"])(),Object(c["d"])("div",bt,[(Object(c["p"])(!0),Object(c["d"])(c["a"],null,Object(c["v"])(i.child.attachment,(function(t){return Object(c["p"])(),Object(c["d"])("div",{key:t.url,class:"attachment"},[Object(c["g"])(s,{attachment:t},null,8,["attachment"])])})),128))])):Object(c["e"])("",!0),i.child.name?(Object(c["p"])(),Object(c["d"])("h2",{key:1,innerHTML:i.child.name},null,8,["innerHTML"])):Object(c["e"])("",!0),i.child.summary?(Object(c["p"])(),Object(c["d"])("h3",{key:2,innerHTML:i.child.summary},null,8,["innerHTML"])):Object(c["e"])("",!0),i.child.content?(Object(c["p"])(),Object(c["d"])("div",{key:3,class:"activity-payload-content",innerHTML:i.child.content},null,8,["innerHTML"])):Object(c["e"])("",!0)])),n.is_reply?Object(c["e"])("",!0):(Object(c["p"])(),Object(c["d"])("div",jt,[Object(c["g"])("div",ft,[Object(c["g"])("ul",null,[Object(c["g"])("li",null,[Object(c["g"])("a",{onClick:e[1]||(e[1]=Object(c["F"])((function(t){return a.reply()}),["prevent"]))},[Ot])]),Object(c["g"])("li",null,[Object(c["g"])("a",{onClick:e[2]||(e[2]=Object(c["F"])((function(t){return a.like()}),["prevent"]))},[mt])]),Object(c["g"])("li",null,[Object(c["g"])("a",{onClick:e[3]||(e[3]=Object(c["F"])((function(t){return a.announce()}),["prevent"]))},[vt])])])]),Object(c["g"])("div",yt,Object(c["y"])(i.interactions)+" interactions ",1)]))])])}var wt={name:"Activity",props:["activity","is_reply"],components:{Attachment:I},data:function(){var t=this.activity.object,e=null;return("Announce"===this.activity.type||"Like"===this.activity.type||t.inReplyTo&&!this.is_reply)&&(e={type:"Create",object:t,actor:t.attributedTo}),{type:this.activity.type,child:t,actor:null,child_actor:null,in_reply_to:null,interactions:t.interactionCount,announcement:e}},mounted:function(){var t=this,e=this.$root.actor;e.fetchObject(this.activity.actor).then((function(e){t.actor=e})),this.child&&this.child.attributedTo&&e.fetchObject(this.child.attributedTo).then((function(e){t.child_actor=e}));var n=!this.is_reply;n&&this.child&&this.child.inReplyTo&&e.fetchObject(this.child.inReplyTo).then((function(e){t.in_reply_to={type:"Create",object:e,actor:e.attributedTo}}))},methods:{reply:function(){this.$root.showComposerModal="text",this.$root.showComposerModalInReplyTo=this.child},like:function(){var t=this.$root.actor;t.like(this.child)},announce:function(){var t=this.$root.actor;t.announce(this.child)}}};n("c324");wt.render=gt;var kt=wt,At={name:"ActivityCollection",props:["activities"],components:{Activity:kt}};At.render=et;var Ct=At,xt={name:"InboxCollection",props:["actor"],components:{ActivityCollection:Ct},data:function(){return{page:-1,activities:[]}},mounted:function(){this.actor&&(this.loadMoreActivities(),window.addEventListener("scroll",this.handleScroll))},unmounted:function(){window.removeEventListener("scroll",this.handleScroll)},methods:{loadMoreActivities:function(){var t=this;this.page++,this.actor.fetchInbox(this.page).then((function(e){t.activities=t.activities.concat(e.orderedItems.filter((function(t){if(-1!=["Create","Announce"].indexOf(t.type))return!0})))})).catch((function(t){console.log("error:",t)}))},handleScroll:function(){var t=this.$el,e=t.getBoundingClientRect();window.innerHeight>e.bottom&&this.loadMoreActivities()}}};xt.render=tt;var _t=xt,Tt={key:0,class:"composer"},Mt={class:"composer-me"},Lt={class:"composer-container"},Pt={class:"composer-post-types"},$t=Object(c["g"])("i",{class:"composer-icon icon-font"},null,-1),Et=Object(c["g"])("br",null,null,-1),St=Object(c["f"])(" Text "),Ut=Object(c["g"])("i",{class:"composer-icon icon-camera"},null,-1),Bt=Object(c["g"])("br",null,null,-1),Rt=Object(c["f"])(" Image "),Ft=Object(c["g"])("i",{class:"composer-icon icon-videocam"},null,-1),It=Object(c["g"])("br",null,null,-1),Nt=Object(c["f"])(" Video "),Ht=Object(c["g"])("i",{class:"composer-icon icon-volume-up"},null,-1),Dt=Object(c["g"])("br",null,null,-1),zt=Object(c["f"])(" Audio ");function Vt(t,e,n,o,i,a){return t.$root.actor?(Object(c["p"])(),Object(c["d"])("div",Tt,[Object(c["g"])("div",Mt,[Object(c["g"])("img",{src:t.$root.actor.iconURL(),alt:"$root.actor.data.name"},null,8,["src"])]),Object(c["g"])("div",Lt,[Object(c["g"])("div",Pt,[Object(c["g"])("div",{class:"composer-post-type",onClick:e[1]||(e[1]=function(t){return a.openComposerModal("text")})},[$t,Et,St]),Object(c["g"])("div",{class:"composer-post-type",onClick:e[2]||(e[2]=function(t){return a.openComposerModal("image")})},[Ut,Bt,Rt]),Object(c["g"])("div",{class:"composer-post-type",onClick:e[3]||(e[3]=function(t){return a.openComposerModal("video")})},[Ft,It,Nt]),Object(c["g"])("div",{class:"composer-post-type",onClick:e[4]||(e[4]=function(t){return a.openComposerModal("audio")})},[Ht,Dt,zt])])])])):Object(c["e"])("",!0)}var Wt={name:"Composer",methods:{openComposerModal:function(t){this.$root.showComposerModal=t}}};n("4183");Wt.render=Vt;var Jt=Wt,qt={name:"Home",components:{InboxCollection:_t,Composer:Jt},mounted:function(){this.$root.actor||this.$router.push("/.well-known/jejune/login")}};n("18f1");qt.render=Z;var Gt=qt;function Kt(t,e,n,o,i,a){var r=Object(c["w"])("login-form");return Object(c["p"])(),Object(c["d"])(r)}var Qt={class:"login-form-container"},Xt=Object(c["g"])("h2",null,"Jejune",-1),Yt={key:0,class:"login-error"},Zt={class:"form-input"},te=Object(c["g"])("label",{for:"username"},"Username",-1),ee={class:"form-input"},ne=Object(c["g"])("label",{for:"password"},"Password",-1),ce=Object(c["g"])("button",{type:"submit",id:"login"},"Log In",-1);function oe(t,e,n,o,i,a){return Object(c["p"])(),Object(c["d"])("div",Qt,[Object(c["g"])("form",{onSubmit:e[3]||(e[3]=Object(c["F"])((function(e){return a.submit(t.user)}),["prevent"])),class:"login-form"},[Xt,t.authError?(Object(c["p"])(),Object(c["d"])("div",Yt,Object(c["y"])(t.authError),1)):Object(c["e"])("",!0),Object(c["g"])("div",Zt,[te,Object(c["D"])(Object(c["g"])("input",{id:"username","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.username=e}),type:"text"},null,512),[[c["A"],t.username]])]),Object(c["g"])("div",ee,[ne,Object(c["D"])(Object(c["g"])("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=function(e){return t.password=e}),type:"password"},null,512),[[c["A"],t.password]])]),ce],32)])}n("d3b7"),n("ac1f"),n("1276");var ie=function(t){return new Promise((function(e,n){t||n(new Error("invalid account"));var c=t.split("@",2);2!=c.length&&n(new Error("must use username@domain format")),console.log("[WEBFINGER] Discovering",c),fetch("https://".concat(c[1],"/.well-known/webfinger?resource=acct:").concat(t)).then((function(t){return t.json()})).then((function(t){console.log("[WEBFINGER] Response:",t),e(t)})).catch((function(t){n(t)}))}))},ae=function(t){return new Promise((function(e,n){ie(t).then((function(t){var c=t.links||[];c.forEach((function(t){"application/activity+json"===t.type&&e(t.href)})),n("no ActivityPub actor found!")})).catch((function(t){n(t)}))}))},re={finger:ie,discoverActor:ae};n("841c");function se(t){this.data=t}se.prototype.inboxURL=function(){return this.data.inbox?this.data.inbox:null},se.prototype.iconURL=function(){return this.data.icon&&this.data.icon.url?this.data.icon.url:null},se.prototype.search=function(t){var e=this;return new Promise((function(n,c){e.data.endpoints.searchEndpoint||c("no search endpoint available"),fetch("".concat(e.data.endpoints.searchEndpoint,"?q=").concat(t),{headers:{Accept:"application/activity+json",Authorization:"Bearer ".concat(e.token.access_token)}}).then((function(t){return t.json()})).then((function(t){n(t)})).catch((function(t){c(t)}))}))},se.prototype.follow=function(t){var e=[t],n=[],c=e.concat(n),o={"@context":"https://www.w3.org/ns/activitystreams",to:e,cc:n,actor:this.data.id,audience:c,type:"Follow",object:t};return this.pushMessageToOutbox(o)},se.prototype.like=function(t){var e=["https://www.w3.org/ns/activitystreams#Public",t.attributedTo],n=[this.data.followers],c=e.concat(n),o={"@context":"https://www.w3.org/ns/activitystreams",to:e,cc:n,actor:this.data.id,audience:c,type:"Like",object:t.id};return this.pushMessageToOutbox(o)},se.prototype.announce=function(t){var e=["https://www.w3.org/ns/activitystreams#Public",t.attributedTo],n=[this.data.followers],c=e.concat(n),o={"@context":"https://www.w3.org/ns/activitystreams",to:e,cc:n,actor:this.data.id,audience:c,type:"Announce",object:t.id};return this.pushMessageToOutbox(o)},se.prototype.pushMessageToOutbox=function(t){var e=this;return new Promise((function(n,c){var o=e.data.outbox;fetch(o,{method:"POST",headers:{Accept:"application/activity+json",Authorization:"Bearer ".concat(e.token.access_token),"Content-Type":"application/activity+json"},body:JSON.stringify(t)}).then((function(t){return t.json()})).then((function(t){n(t)})).catch((function(t){c(t)}))}))},se.prototype.fetchMailboxWithToken=function(t){var e=this;return new Promise((function(n,c){fetch(t,{headers:{Accept:"application/activity+json",Authorization:"Bearer ".concat(e.token.access_token)}}).then((function(t){return t.json()})).then((function(t){n(t)})).catch((function(t){c(t)}))}))},se.prototype.fetchInbox=function(t){var e=this;return new Promise((function(n,c){e.token||c("no token for fetching inbox");var o=e.inboxURL()+"?page=".concat(t);e.fetchMailboxWithToken(o).then((function(t){n(t)})).catch((function(t){c(t)}))}))},se.prototype.uploadMediaEndpoint=function(){return this.data.endpoints.uploadMedia},se.prototype.uploadMedia=function(t){var e=this;return new Promise((function(n,c){var o=e.uploadMediaEndpoint();o||c("Media upload endpoint is not available.");var i=new FormData;i.append("file",t),fetch(o,{method:"POST",headers:{Accept:"application/activity+json",Authorization:"Bearer ".concat(e.token.access_token)},body:i}).then((function(t){return t.json()})).then((function(t){n(t)})).catch((function(t){c(t)}))}))},se.prototype.setToken=function(t){this.token=t},se.prototype.oAuthEndpoints=function(){var t={};return this.data.endpoints.oauthRegistrationEndpoint&&(t.registration=this.data.endpoints.oauthRegistrationEndpoint),this.data.endpoints.oauthAuthorizationEndpoint&&(t.authorization=this.data.endpoints.oauthAuthorizationEndpoint),this.data.endpoints.oauthTokenEndpoint&&(t.token=this.data.endpoints.oauthTokenEndpoint),t},se.prototype.search=function(t){var e=this;return new Promise((function(n,c){e.data.endpoints.searchEndpoint||c("Search endpoint is not present for the session actor.");var o=e.data.endpoints.searchEndpoint;fetch("".concat(o,"?q=").concat(t),{headers:{Accept:"application/activity+json",Authorization:"Bearer ".concat(e.token.access_token)}}).then((function(t){return t.json()})).then((function(t){n(t)})).catch((function(t){c(t)}))}))},se.prototype.fetchObject=function(t){var e=this;return this.data.endpoints.proxyUrl?new Promise((function(n,c){var o=e.data.endpoints.proxyUrl,i=new FormData;i.append("id",t),fetch(o,{method:"POST",headers:{Authorization:"Bearer ".concat(e.token.access_token)},body:i}).then((function(t){return t.json()})).then((function(t){n(t)})).catch((function(t){c(t)}))})):ue(t)};var le=function(t){return new Promise((function(e,n){fetch(t,{headers:{Accept:"application/activity+json"}}).then((function(t){return t.json()})).then((function(t){e(new se(t))})).catch((function(t){n(t)}))}))},ue=function(t){return new Promise((function(e,n){fetch(t,{headers:{Accept:"application/activity+json"}}).then((function(t){return t.json()})).then((function(t){e(t)})).catch((function(t){n(t)}))}))},de={fetchActor:le,fetchObject:ue},pe=function(t){return new Promise((function(e,n){var c=new FormData;c.append("client_name","Jejune Client"),c.append("redirect_uris","urn:ietf:wg:oauth:2.0:oob"),c.append("scopes","read write follow push");var o=t.oAuthEndpoints();fetch(o.registration,{method:"POST",body:c}).then((function(t){return t.json()})).then((function(t){e(t)})).catch((function(t){n(t)}))}))},he=function(t,e,n,c){return new Promise((function(o,i){var a=t.oAuthEndpoints(),r=n.split("@",2)[0],s=new FormData;s.append("username",r),s.append("password",c),s.append("grant_type","password"),s.append("client_id",e.client_id),s.append("client_secret",e.client_secret),fetch(a.token,{method:"POST",body:s}).then((function(t){return t.ok||i("Unable to acquire an OAuth session token with the supplied credentials."),t.json()})).then((function(t){o(t)})).catch((function(t){i(t)}))}))},be=function(t,e,n){return new Promise((function(c,o){pe(t).then((function(i){console.log("[OAUTH] App token:",i),he(t,i,e,n).then((function(t){c(t)})).catch((function(t){o(t)}))})).catch((function(t){o(t)}))}))},je={getToken:be},fe=function(t,e){return console.log("[TOPLEVEL] Attempting login for ".concat(t)),new Promise((function(n,c){re.discoverActor(t).then((function(o){de.fetchActor(o).then((function(o){je.getToken(o,t,e).then((function(t){o.setToken(t),n(o)})).catch((function(t){c(t)}))})).catch((function(t){c(t)}))})).catch((function(t){c(t)}))}))},Oe={login:fe},me={name:"LoginForm",data:function(){return{username:null,password:null,authError:null}},methods:{submit:function(){var t=this;Oe.login(this.username,this.password).then((function(e){t.$root.actor=e,t.$router.push("/.well-known/jejune")})).catch((function(e){console.log("Login error:",e),t.authError=e}))}}};n("d2ee");me.render=oe;var ve=me,ye={name:"Login",components:{LoginForm:ve}};ye.render=Kt;var ge=ye,we={class:"dashboard-parent"};function ke(t,e,n,o,i,a){var r=Object(c["w"])("SearchResult");return Object(c["p"])(),Object(c["d"])("div",we,[(Object(c["p"])(!0),Object(c["d"])(c["a"],null,Object(c["v"])(i.results,(function(t){return Object(c["p"])(),Object(c["d"])(r,{key:t.id,result:t},null,8,["result"])})),128))])}var Ae={class:"search-result"};function Ce(t,e,n,o,i,a){var r=Object(c["w"])("ActorCard");return Object(c["p"])(),Object(c["d"])("div",Ae,[-1!=["Person","Group","Application","Service","Organization"].indexOf(n.result.type)?(Object(c["p"])(),Object(c["d"])(r,{key:0,actor:n.result},null,8,["actor"])):Object(c["e"])("",!0)])}var xe={class:"activity-container"},_e={class:"activity-author"},Te={class:"activity-content"},Me={class:"activity-header"},Le={class:"activity-author-name"},Pe={class:"activity-author-actions"},$e=Object(c["g"])("i",{class:"icon-user-plus"},null,-1),Ee=Object(c["g"])("i",{class:"icon-user-times"},null,-1);function Se(t,e,n,o,i,a){return Object(c["p"])(),Object(c["d"])("div",xe,[Object(c["g"])("div",_e,[n.actor?(Object(c["p"])(),Object(c["d"])("a",{key:0,href:n.actor.url,target:"_blank",title:n.actor.name},[Object(c["g"])("img",{src:n.actor.icon.url,class:"activity-icon"},null,8,["src"])],8,["href","title"])):Object(c["e"])("",!0)]),Object(c["g"])("div",Te,[Object(c["g"])("div",Me,[Object(c["g"])("div",Le,[Object(c["g"])("span",null,[Object(c["g"])("a",{href:n.actor.url,target:"_blank"},Object(c["y"])(n.actor.name),9,["href"])])]),Object(c["g"])("div",Pe,[Object(c["g"])("span",{onClick:e[1]||(e[1]=function(t){return a.follow(n.actor)})},[$e]),Object(c["g"])("span",{onClick:e[2]||(e[2]=function(t){return a.unfollow(n.actor)})},[Ee])])]),Object(c["g"])("div",{class:"activity-payload",innerHTML:n.actor.summary},null,8,["innerHTML"]),Object(c["g"])("div",{class:"activity-footer actor-petname",textContent:Object(c["y"])(n.actor.petName)},null,8,["textContent"])])])}var Ue={name:"ActorCard",props:["actor"],methods:{follow:function(t){var e=this.$root.actor;e.follow(t.id)},unfollow:function(t){console.log("Unfollowing not implemented yet:",t)}}};n("8991");Ue.render=Se;var Be=Ue,Re={name:"SearchResult",components:{ActorCard:Be},props:["result"]};Re.render=Ce;var Fe=Re,Ie={name:"Search",components:{SearchResult:Fe},data:function(){return{results:[]}},mounted:function(){var t=this,e=this.$root.actor,n=this.$root.search_term;e.search(n).then((function(e){t.results=e.items||[]}))}};Ie.render=ke;var Ne=Ie,He=[{path:"/.well-known/jejune",name:"Home",component:Gt},{path:"/.well-known/jejune/login",name:"Login",component:ge},{path:"/.well-known/jejune/search",name:"Search",component:Ne}],De=Object(G["a"])({history:Object(G["b"])("/"),routes:He}),ze=De;Object(c["c"])(q).use(ze).mount("#app")},"65ea":function(t,e,n){"use strict";n("7204")},"6cf1":function(t,e,n){},7204:function(t,e,n){},"81aa":function(t,e,n){},8991:function(t,e,n){"use strict";n("6cf1")},9095:function(t,e,n){},9647:function(t,e,n){},9843:function(t,e,n){"use strict";n("b5e4")},b305:function(t,e,n){},b5e4:function(t,e,n){},bc81:function(t,e,n){},c324:function(t,e,n){"use strict";n("bc81")},d1b8:function(t,e,n){"use strict";n("9647")},d2ee:function(t,e,n){"use strict";n("9095")}});
//# sourceMappingURL=app.4861ac10.js.map